/* ============================================================
   SPA LAYOUT — Left Sidebar + Page Router
   ============================================================ */

/* Root layout */
.app-layout {
  display: flex;
  min-height: 100vh;
  width: 100%;
}

/* ── SIDEBAR ── */
:root {
  --sidebar-w: 220px;
  --sidebar-wc: 56px;
}

.sidebar {
  position: fixed;
  top: 0; left: 0;
  height: 100vh;
  width: var(--sidebar-w);
  background: var(--bg-header);
  border-right: 1px solid var(--border-subtle, rgba(255,255,255,0.06));
  display: flex;
  flex-direction: column;
  z-index: 200;
  transition: width var(--transition, 0.2s);
  overflow: hidden;
  box-shadow: 2px 0 8px rgba(0,0,0,0.12);
}
.sidebar.collapsed { width: var(--sidebar-wc); }

/* Logo */
.sidebar-logo {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 0 16px;
  height: 60px;
  flex-shrink: 0;
  border-bottom: 1px solid var(--border-subtle, rgba(255,255,255,0.06));
  overflow: hidden;
  white-space: nowrap;
}
.sidebar-logo-icon { width: 22px; height: 22px; flex-shrink: 0; border-radius: 4px; }
.sidebar-logo-text {
  font-weight: 700; font-size: 0.82rem; letter-spacing: 0.07em;
  text-transform: uppercase; color: var(--text-primary);
  transition: opacity var(--transition, 0.2s);
}
.sidebar.collapsed .sidebar-logo-text { opacity: 0; pointer-events: none; }

/* Collapse toggle */
.sidebar-collapse-btn {
  position: absolute; top: 18px; right: -11px;
  width: 22px; height: 22px;
  background: var(--bg-elevated, #1e2030);
  border: 1px solid var(--border-soft, rgba(255,255,255,0.1));
  border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  cursor: pointer; z-index: 10;
  color: var(--text-muted); font-size: 0.6rem;
  transition: all var(--transition, 0.2s);
  box-shadow: 0 1px 4px rgba(0,0,0,0.2);
}
.sidebar-collapse-btn:hover { color: var(--text-primary); border-color: var(--border-strong, rgba(255,255,255,0.2)); }
.sidebar-collapse-btn i { transition: transform var(--transition, 0.2s); }
.sidebar.collapsed .sidebar-collapse-btn i { transform: rotate(180deg); }

/* Navigation */
.sidebar-nav {
  flex: 1;
  overflow-y: auto; overflow-x: hidden;
  padding: 10px 0;
  scrollbar-width: none;
}
.sidebar-nav::-webkit-scrollbar { display: none; }
.sidebar-nav-list { list-style: none; margin: 0; padding: 0 6px; }
.sidebar-nav-list + .sidebar-nav-list { margin-top: 4px; }

.sidebar-nav-item {
  display: flex; align-items: center; gap: 10px;
  padding: 9px 10px;
  border-radius: 7px;
  color: var(--text-secondary, #9ca3af);
  text-decoration: none;
  font-size: 0.875rem; font-weight: 500;
  transition: background var(--transition-fast, 0.12s), color var(--transition-fast, 0.12s);
  white-space: nowrap; overflow: hidden;
  margin-bottom: 2px;
  position: relative;
  cursor: pointer;
  background: transparent; border: none; width: 100%; text-align: left;
}
.sidebar-nav-item i { font-size: 0.95rem; width: 20px; text-align: center; flex-shrink: 0; }
.sidebar-nav-label { transition: opacity var(--transition, 0.2s); }
.sidebar.collapsed .sidebar-nav-label { opacity: 0; pointer-events: none; }

.sidebar-nav-item:hover { background: var(--dropdown-hover, rgba(255,255,255,0.06)); color: var(--text-primary, #e5e7eb); }
.sidebar-nav-item.active { background: rgba(99,102,241,0.15); color: var(--primary, #6366f1); font-weight: 600; }
.sidebar-nav-item.active i { color: var(--primary, #6366f1); }

/* Tooltip in collapsed state */
.sidebar.collapsed .sidebar-nav-item {
  overflow: visible;
}
.sidebar.collapsed .sidebar-nav-item::after {
  content: attr(data-tooltip);
  position: absolute; left: calc(var(--sidebar-wc) - 4px); top: 50%;
  transform: translateY(-50%);
  background: var(--bg-elevated, #1e2030);
  color: var(--text-primary, #e5e7eb);
  font-size: 0.8rem; font-weight: 500;
  padding: 5px 10px;
  border-radius: 6px;
  border: 1px solid var(--border-soft, rgba(255,255,255,0.1));
  white-space: nowrap;
  opacity: 0; pointer-events: none;
  transition: opacity 0.15s;
  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
  z-index: 9999;
}
.sidebar.collapsed .sidebar-nav-item:hover::after { opacity: 1; }

/* Divider */
.sidebar-divider {
  height: 1px;
  background: var(--border-subtle, rgba(255,255,255,0.06));
  margin: 6px 12px;
}

/* Sidebar footer */
.sidebar-footer {
  flex-shrink: 0;
  padding: 8px 6px 12px;
  border-top: 1px solid var(--border-subtle, rgba(255,255,255,0.06));
  display: flex; flex-direction: column; gap: 2px;
}
.sidebar-footer-btn {
  display: flex; align-items: center; gap: 10px;
  padding: 9px 10px;
  border-radius: 7px;
  background: transparent; border: none;
  color: var(--text-secondary, #9ca3af);
  font-size: 0.875rem; cursor: pointer;
  transition: background var(--transition-fast, 0.12s), color var(--transition-fast, 0.12s);
  white-space: nowrap; overflow: hidden; width: 100%; text-align: left;
}
.sidebar-footer-btn:hover { background: var(--dropdown-hover, rgba(255,255,255,0.06)); color: var(--text-primary, #e5e7eb); }
.sidebar-footer-btn i { font-size: 0.95rem; width: 20px; text-align: center; flex-shrink: 0; }

/* Connection dot in sidebar */
.sidebar-connection {
  font-size: 0.8rem;
}
.sidebar-connection i { font-size: 0.5rem; margin-top: 1px; }
.sidebar-connection.connected i { color: #22c55e; }
.sidebar-connection.disconnected i { color: #ef4444; }

/* Theme toggle icons — show one based on theme */
[data-theme="dark"]  .theme-icon-light { display: inline-block; }
[data-theme="dark"]  .theme-icon-dark  { display: none; }
[data-theme="light"] .theme-icon-light { display: none; }
[data-theme="light"] .theme-icon-dark  { display: inline-block; }

/* ── MAIN CONTENT ── */
.app-main {
  margin-left: var(--sidebar-w);
  flex: 1;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  transition: margin-left var(--transition, 0.2s);
  overflow-x: hidden;
}
body.sidebar-collapsed .app-main { margin-left: var(--sidebar-wc); }

/* ── PAGES ── */
.page {
  display: none;
  flex-direction: column;
  padding: 28px 32px;
  flex: 1;
}
.page.active { display: flex; }

/* Page header */
.page-header {
  display: flex; align-items: center; justify-content: space-between;
  margin-bottom: 24px; gap: 16px; flex-wrap: wrap;
}
.page-title {
  font-size: 1.45rem; font-weight: 700;
  color: var(--text-primary, #e5e7eb);
  display: flex; align-items: center; gap: 10px;
  margin: 0;
}
.page-title i { color: var(--primary, #6366f1); font-size: 1.2rem; }
.page-actions { display: flex; align-items: center; gap: 8px; flex-wrap: wrap; }

/* ── SETTINGS / NOTIFICATIONS page sections ── */
.settings-section {
  background: var(--bg-card, #16213e);
  border: 1px solid var(--border-subtle, rgba(255,255,255,0.06));
  border-radius: 10px;
  padding: 24px;
  margin-bottom: 20px;
}
.settings-section-header {
  border-bottom: 1px solid var(--border-subtle, rgba(255,255,255,0.06));
  padding-bottom: 14px;
  margin-bottom: 20px;
}
.settings-section-header h2 {
  font-size: 0.95rem; font-weight: 600;
  color: var(--text-primary, #e5e7eb);
  display: flex; align-items: center; gap: 8px;
  margin: 0;
}
.settings-section-header h2 i { color: var(--primary, #6366f1); font-size: 0.9rem; }

/* Sticky save bar */
.settings-sticky-save {
  position: sticky; bottom: 0;
  background: var(--bg-header, #0f172a);
  border-top: 1px solid var(--border-soft, rgba(255,255,255,0.08));
  padding: 14px 32px;
  display: flex; justify-content: flex-end; gap: 10px;
  z-index: 10;
  backdrop-filter: blur(10px);
  margin: 0 -32px -28px; /* bleed to page edges */
}

/* Audit log page — override fixed height from modal version */
.audit-log-page { max-height: none !important; overflow: visible !important; }

/* Mobile hamburger (hidden on desktop) */
.sidebar-mobile-btn {
  display: none;
  position: fixed; top: 12px; left: 12px;
  z-index: 201;
  background: var(--bg-elevated, #1e2030);
  border: 1px solid var(--border-soft, rgba(255,255,255,0.1));
  border-radius: 7px;
  width: 38px; height: 38px;
  align-items: center; justify-content: center;
  cursor: pointer; color: var(--text-primary);
  font-size: 1rem;
}
.sidebar-mobile-overlay {
  display: none;
  position: fixed; inset: 0;
  background: rgba(0,0,0,0.5);
  z-index: 199;
}

/* ── RESPONSIVE ── */
@media (max-width: 900px) {
  .sidebar {
    transform: translateX(-100%);
    width: var(--sidebar-w) !important;
    transition: transform var(--transition, 0.2s);
    z-index: 300;
  }
  .sidebar.mobile-open { transform: translateX(0); box-shadow: 4px 0 24px rgba(0,0,0,0.4); }
  .app-main { margin-left: 0 !important; }
  .sidebar-mobile-btn { display: flex; }
  .sidebar-mobile-overlay.active { display: block; }
  .sidebar-collapse-btn { display: none; }
  .page { padding: 16px; }
  .settings-sticky-save { margin: 0 -16px -16px; padding: 12px 16px; }
}

/* Light theme sidebar adjustments */
[data-theme="light"] .sidebar {
  background: var(--bg-header);
  box-shadow: 2px 0 8px rgba(0,0,0,0.06);
}
[data-theme="light"] .sidebar-collapse-btn {
  background: #fff;
  border-color: var(--border-soft);
}
[data-theme="light"] .settings-section {
  background: #fff;
  border-color: var(--border-soft);
}
[data-theme="light"] .settings-sticky-save {
  background: var(--bg-header);
  border-color: var(--border-soft);
}
